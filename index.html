<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Line-by-Line TTS</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 800px;
      margin: 20px auto;
      padding: 0 10px;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 8px;
      box-sizing: border-box;
      font-family: inherit;
      font-size: 14px;
    }
    button {
      margin-top: 10px;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
    }
    .line-block {
      margin-top: 15px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .line-text {
      font-weight: bold;
      margin-bottom: 5px;
      word-break: break-word;
    }
    .audio-link {
      font-size: 12px;
      display: block;
      margin-top: 4px;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h1>Text to Speech (One Line per Audio)</h1>

  <p>Write one sentence per line. Each line will be converted into a separate audio file.</p>

  <textarea id="text-input" placeholder="Type or paste text here&#10;Each line will become a separate audio..."></textarea>
  <br />
  <button id="generate-btn">Generate Audio</button>

  <div id="results"></div>

  <script>
    const ENDPOINT_BASE = "https://verceledge-fawn.vercel.app/api/tts?text=";

    document.getElementById("generate-btn").addEventListener("click", () => {
      const textarea = document.getElementById("text-input");
      const resultsDiv = document.getElementById("results");

      // Clear old results
      resultsDiv.innerHTML = "";

      // Split into lines, trim, and remove empty lines
      const lines = textarea.value
        .split(/\r?\n/)
        .map(line => line.trim())
        .filter(line => line.length > 0);

      if (lines.length === 0) {
        resultsDiv.textContent = "No lines to convert.";
        return;
      }

      lines.forEach((line, index) => {
        const encodedText = encodeURIComponent(line);
        const audioUrl = ENDPOINT_BASE + encodedText;

        // Create container for this line's result
        const block = document.createElement("div");
        block.className = "line-block";

        const lineText = document.createElement("div");
        lineText.className = "line-text";
        lineText.textContent = `Line ${index + 1}: ${line}`;

        const audio = document.createElement("audio");
        audio.controls = true;
        audio.src = audioUrl;

        const link = document.createElement("a");
        link.className = "audio-link";
        link.href = audioUrl;
        link.target = "_blank";
        link.textContent = audioUrl;

        block.appendChild(lineText);
        block.appendChild(audio);
        block.appendChild(link);
        resultsDiv.appendChild(block);
      });
    });
  </script>
</body>
</html>
